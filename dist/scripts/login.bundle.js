webpackJsonp([4],{0:function(t,exports,n){(function($){function t(){$.AMUI.progress.set(.8),a.button("loading")}function o(){$.AMUI.progress.done(),a.button("reset")}var e=n(2);n(4),n(15);var i={};$.post(e.URL.RSA_KEY).done(function(t){t&&t.content&&(i.exponent=t.content.e,i.modulus=t.content.n)}),$("#username").on("change",function(){var t=$(this);t.val($.trim(t.val()).toUpperCase())}),$("#validateCodeDiv").on("click","a",function(){var t=$(this).prev()[0];t.src=e.URL.VALIDATA_IMG+"?"+Math.random()});var a=$("#loginBtn");$("#loginForm").submit(function(n){n.preventDefault();var a=$("#username"),s=$("#password"),r=$("#validateCode"),l=$.trim(s.val()),c=$.trim(a.val()),u=$.trim(r.val());if(""===c)e.UI.toast("请填写用户名");else if(""===l)e.UI.toast("请填写密码");else if($("#validateCodeDiv").is(":visible")&&""===u)e.UI.toast("请填写验证码");else{t();var d=$(this);if(i.exponent&&i.modulus){var v=e.RSAUtils.getKeyPair(i.exponent,"",i.modulus),f=e.RSAUtils.encryptedString(v,l);s.val(f)}$.post(e.URL.LOGIN,d.serializeArray()).done(function(t){t&&"success"===t.status?(i.sessionid=t.content.sessionid,i.firstLogin=t.content.firstLogin,e.storage.set(e.storage.CEIS_SESSION,i),i.firstLogin?(e.UI.toast("首次登陆或密码过期，请修改密码！"),e.forward("./modifypwd.html")):(e.UI.toast("登录成功！"),e.forward("./index.html"))):(s.val(""),e.UI.toast(t.msg),o(),t.content&&"org.apache.shiro.authc.AuthenticationException"==t.content.shiroLoginFailure&&$("#validateCodeDiv").show(),$("#validateCodeDiv a").click())}).always(function(t){o()})}})}).call(exports,n(1))},15:function(t,exports){}});